var xt=s=>{throw TypeError(s)};var ut=(s,t,e)=>t.has(s)||xt("Cannot "+e);var i=(s,t,e)=>(ut(s,t,"read from private field"),e?e.call(s):t.get(s)),p=(s,t,e)=>t.has(s)?xt("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,e),l=(s,t,e,r)=>(ut(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e),d=(s,t,e)=>(ut(s,t,"access private method"),e);import{H as kt,I as Qt,J as M,K as et,M as V,N as st,O as ct,Q as It,T as Ht,U as jt,W as zt,X as Tt,Y as it,Z as _t,_ as Nt,r as C,$ as qt,z as J,c as $t,l as rt,k as j,w as Rt}from"./index-BjMCP1iW.js";var R,h,W,b,A,P,T,_,Y,K,B,L,k,D,H,u,$,lt,dt,ft,pt,mt,gt,vt,Pt,At,Vt=(At=class extends kt{constructor(t,e){super();p(this,u);p(this,R);p(this,h);p(this,W);p(this,b);p(this,A);p(this,P);p(this,T);p(this,_);p(this,Y);p(this,K);p(this,B);p(this,L);p(this,k);p(this,D);p(this,H,new Set);this.options=e,l(this,R,t),l(this,_,null),l(this,T,Qt()),this.options.experimental_prefetchInRender||i(this,T).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(i(this,h).addObserver(this),Dt(i(this,h),this.options)?d(this,u,$).call(this):this.updateResult(),d(this,u,pt).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return yt(i(this,h),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return yt(i(this,h),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,d(this,u,mt).call(this),d(this,u,gt).call(this),i(this,h).removeObserver(this)}setOptions(t){const e=this.options,r=i(this,h);if(this.options=i(this,R).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof M(this.options.enabled,i(this,h))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");d(this,u,vt).call(this),i(this,h).setOptions(this.options),e._defaulted&&!et(this.options,e)&&i(this,R).getQueryCache().notify({type:"observerOptionsUpdated",query:i(this,h),observer:this});const n=this.hasListeners();n&&Ft(i(this,h),r,this.options,e)&&d(this,u,$).call(this),this.updateResult(),n&&(i(this,h)!==r||M(this.options.enabled,i(this,h))!==M(e.enabled,i(this,h))||V(this.options.staleTime,i(this,h))!==V(e.staleTime,i(this,h)))&&d(this,u,lt).call(this);const o=d(this,u,dt).call(this);n&&(i(this,h)!==r||M(this.options.enabled,i(this,h))!==M(e.enabled,i(this,h))||o!==i(this,D))&&d(this,u,ft).call(this,o)}getOptimisticResult(t){const e=i(this,R).getQueryCache().build(i(this,R),t),r=this.createResult(e,t);return Yt(this,r)&&(l(this,b,r),l(this,P,this.options),l(this,A,i(this,h).state)),r}getCurrentResult(){return i(this,b)}trackResult(t,e){return new Proxy(t,{get:(r,n)=>(this.trackProp(n),e==null||e(n),Reflect.get(r,n))})}trackProp(t){i(this,H).add(t)}getCurrentQuery(){return i(this,h)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=i(this,R).defaultQueryOptions(t),r=i(this,R).getQueryCache().build(i(this,R),e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return d(this,u,$).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),i(this,b)))}createResult(t,e){var Mt;const r=i(this,h),n=this.options,o=i(this,b),a=i(this,A),m=i(this,P),v=t!==r?t.state:i(this,W),{state:y}=t;let c={...y},x=!1,g;if(e._optimisticResults){const w=this.hasListeners(),X=!w&&Dt(t,e),q=w&&Ft(t,r,e,n);(X||q)&&(c={...c,...zt(y.data,t.options)}),e._optimisticResults==="isRestoring"&&(c.fetchStatus="idle")}let{error:z,errorUpdatedAt:N,status:O}=c;g=c.data;let G=!1;if(e.placeholderData!==void 0&&g===void 0&&O==="pending"){let w;o!=null&&o.isPlaceholderData&&e.placeholderData===(m==null?void 0:m.placeholderData)?(w=o.data,G=!0):w=typeof e.placeholderData=="function"?e.placeholderData((Mt=i(this,B))==null?void 0:Mt.state.data,i(this,B)):e.placeholderData,w!==void 0&&(O="success",g=Tt(o==null?void 0:o.data,w,e),x=!0)}if(e.select&&g!==void 0&&!G)if(o&&g===(a==null?void 0:a.data)&&e.select===i(this,Y))g=i(this,K);else try{l(this,Y,e.select),g=e.select(g),g=Tt(o==null?void 0:o.data,g,e),l(this,K,g),l(this,_,null)}catch(w){l(this,_,w)}i(this,_)&&(z=i(this,_),g=i(this,K),N=Date.now(),O="error");const nt=c.fetchStatus==="fetching",ot=O==="pending",ht=O==="error",wt=ot&&nt,Et=g!==void 0,E={status:O,fetchStatus:c.fetchStatus,isPending:ot,isSuccess:O==="success",isError:ht,isInitialLoading:wt,isLoading:wt,data:g,dataUpdatedAt:c.dataUpdatedAt,error:z,errorUpdatedAt:N,failureCount:c.fetchFailureCount,failureReason:c.fetchFailureReason,errorUpdateCount:c.errorUpdateCount,isFetched:c.dataUpdateCount>0||c.errorUpdateCount>0,isFetchedAfterMount:c.dataUpdateCount>v.dataUpdateCount||c.errorUpdateCount>v.errorUpdateCount,isFetching:nt,isRefetching:nt&&!ot,isLoadingError:ht&&!Et,isPaused:c.fetchStatus==="paused",isPlaceholderData:x,isRefetchError:ht&&Et,isStale:St(t,e),refetch:this.refetch,promise:i(this,T)};if(this.options.experimental_prefetchInRender){const w=Z=>{E.status==="error"?Z.reject(E.error):E.data!==void 0&&Z.resolve(E.data)},X=()=>{const Z=l(this,T,E.promise=Qt());w(Z)},q=i(this,T);switch(q.status){case"pending":t.queryHash===r.queryHash&&w(q);break;case"fulfilled":(E.status==="error"||E.data!==q.value)&&X();break;case"rejected":(E.status!=="error"||E.error!==q.reason)&&X();break}}return E}updateResult(){const t=i(this,b),e=this.createResult(i(this,h),this.options);if(l(this,A,i(this,h).state),l(this,P,this.options),i(this,A).data!==void 0&&l(this,B,i(this,h)),et(e,t))return;l(this,b,e);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:n}=this.options,o=typeof n=="function"?n():n;if(o==="all"||!o&&!i(this,H).size)return!0;const a=new Set(o??i(this,H));return this.options.throwOnError&&a.add("error"),Object.keys(i(this,b)).some(m=>{const f=m;return i(this,b)[f]!==t[f]&&a.has(f)})};d(this,u,Pt).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&d(this,u,pt).call(this)}},R=new WeakMap,h=new WeakMap,W=new WeakMap,b=new WeakMap,A=new WeakMap,P=new WeakMap,T=new WeakMap,_=new WeakMap,Y=new WeakMap,K=new WeakMap,B=new WeakMap,L=new WeakMap,k=new WeakMap,D=new WeakMap,H=new WeakMap,u=new WeakSet,$=function(t){d(this,u,vt).call(this);let e=i(this,h).fetch(this.options,t);return t!=null&&t.throwOnError||(e=e.catch(st)),e},lt=function(){d(this,u,mt).call(this);const t=V(this.options.staleTime,i(this,h));if(ct||i(this,b).isStale||!It(t))return;const r=Ht(i(this,b).dataUpdatedAt,t)+1;l(this,L,setTimeout(()=>{i(this,b).isStale||this.updateResult()},r))},dt=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(i(this,h)):this.options.refetchInterval)??!1},ft=function(t){d(this,u,gt).call(this),l(this,D,t),!(ct||M(this.options.enabled,i(this,h))===!1||!It(i(this,D))||i(this,D)===0)&&l(this,k,setInterval(()=>{(this.options.refetchIntervalInBackground||jt.isFocused())&&d(this,u,$).call(this)},i(this,D)))},pt=function(){d(this,u,lt).call(this),d(this,u,ft).call(this,d(this,u,dt).call(this))},mt=function(){i(this,L)&&(clearTimeout(i(this,L)),l(this,L,void 0))},gt=function(){i(this,k)&&(clearInterval(i(this,k)),l(this,k,void 0))},vt=function(){const t=i(this,R).getQueryCache().build(i(this,R),this.options);if(t===i(this,h))return;const e=i(this,h);l(this,h,t),l(this,W,t.state),this.hasListeners()&&(e==null||e.removeObserver(this),t.addObserver(this))},Pt=function(t){it.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(i(this,b))}),i(this,R).getQueryCache().notify({query:i(this,h),type:"observerResultsUpdated"})})},At);function Wt(s,t){return M(t.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function Dt(s,t){return Wt(s,t)||s.state.data!==void 0&&yt(s,t,t.refetchOnMount)}function yt(s,t,e){if(M(t.enabled,s)!==!1&&V(t.staleTime,s)!=="static"){const r=typeof e=="function"?e(s):e;return r==="always"||r!==!1&&St(s,t)}return!1}function Ft(s,t,e,r){return(s!==t||M(r.enabled,s)===!1)&&(!e.suspense||s.state.status!=="error")&&St(s,e)}function St(s,t){return M(t.enabled,s)!==!1&&s.isStaleByTime(V(t.staleTime,s))}function Yt(s,t){return!et(s.getCurrentResult(),t)}var F,U,S,Q,I,tt,bt,Lt,Jt=(Lt=class extends kt{constructor(t,e){super();p(this,I);p(this,F);p(this,U);p(this,S);p(this,Q);l(this,F,t),this.setOptions(e),this.bindMethods(),d(this,I,tt).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const e=this.options;this.options=i(this,F).defaultMutationOptions(t),et(this.options,e)||i(this,F).getMutationCache().notify({type:"observerOptionsUpdated",mutation:i(this,S),observer:this}),e!=null&&e.mutationKey&&this.options.mutationKey&&_t(e.mutationKey)!==_t(this.options.mutationKey)?this.reset():((r=i(this,S))==null?void 0:r.state.status)==="pending"&&i(this,S).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=i(this,S))==null||t.removeObserver(this)}onMutationUpdate(t){d(this,I,tt).call(this),d(this,I,bt).call(this,t)}getCurrentResult(){return i(this,U)}reset(){var t;(t=i(this,S))==null||t.removeObserver(this),l(this,S,void 0),d(this,I,tt).call(this),d(this,I,bt).call(this)}mutate(t,e){var r;return l(this,Q,e),(r=i(this,S))==null||r.removeObserver(this),l(this,S,i(this,F).getMutationCache().build(i(this,F),this.options)),i(this,S).addObserver(this),i(this,S).execute(t)}},F=new WeakMap,U=new WeakMap,S=new WeakMap,Q=new WeakMap,I=new WeakSet,tt=function(){var e;const t=((e=i(this,S))==null?void 0:e.state)??Nt();l(this,U,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},bt=function(t){it.batch(()=>{var e,r,n,o,a,m,f,v;if(i(this,Q)&&this.hasListeners()){const y=i(this,U).variables,c=i(this,U).context;(t==null?void 0:t.type)==="success"?((r=(e=i(this,Q)).onSuccess)==null||r.call(e,t.data,y,c),(o=(n=i(this,Q)).onSettled)==null||o.call(n,t.data,null,y,c)):(t==null?void 0:t.type)==="error"&&((m=(a=i(this,Q)).onError)==null||m.call(a,t.error,y,c),(v=(f=i(this,Q)).onSettled)==null||v.call(f,void 0,t.error,y,c))}this.listeners.forEach(y=>{y(i(this,U))})})},Lt),Kt=C.createContext(!1),Gt=()=>C.useContext(Kt);Kt.Provider;function Xt(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var Zt=C.createContext(Xt()),te=()=>C.useContext(Zt),ee=(s,t)=>{(s.suspense||s.throwOnError||s.experimental_prefetchInRender)&&(t.isReset()||(s.retryOnMount=!1))},se=s=>{C.useEffect(()=>{s.clearReset()},[s])},ie=({result:s,errorResetBoundary:t,throwOnError:e,query:r,suspense:n})=>s.isError&&!t.isReset()&&!s.isFetching&&r&&(n&&s.data===void 0||qt(e,[s.error,r])),re=s=>{if(s.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),e=s.staleTime;s.staleTime=typeof e=="function"?(...r)=>t(e(...r)):t(e),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},ae=(s,t)=>s.isLoading&&s.isFetching&&!t,ne=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,Ut=(s,t,e)=>t.fetchOptimistic(s).catch(()=>{e.clearReset()});function oe(s,t,e){var c,x,g,z,N;const r=J(),n=Gt(),o=te(),a=r.defaultQueryOptions(s);(x=(c=r.getDefaultOptions().queries)==null?void 0:c._experimental_beforeQuery)==null||x.call(c,a),a._optimisticResults=n?"isRestoring":"optimistic",re(a),ee(a,o),se(o);const m=!r.getQueryCache().get(a.queryHash),[f]=C.useState(()=>new t(r,a)),v=f.getOptimisticResult(a),y=!n&&s.subscribed!==!1;if(C.useSyncExternalStore(C.useCallback(O=>{const G=y?f.subscribe(it.batchCalls(O)):st;return f.updateResult(),G},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),C.useEffect(()=>{f.setOptions(a)},[a,f]),ne(a,v))throw Ut(a,f,o);if(ie({result:v,errorResetBoundary:o,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw v.error;if((z=(g=r.getDefaultOptions().queries)==null?void 0:g._experimental_afterQuery)==null||z.call(g,a,v),a.experimental_prefetchInRender&&!ct&&ae(v,n)){const O=m?Ut(a,f,o):(N=r.getQueryCache().get(a.queryHash))==null?void 0:N.promise;O==null||O.catch(st).finally(()=>{f.updateResult()})}return a.notifyOnChangeProps?v:f.trackResult(v)}function he(s,t){return oe(s,Vt)}function Ct(s,t){const e=J(),[r]=C.useState(()=>new Jt(e,s));C.useEffect(()=>{r.setOptions(s)},[r,s]);const n=C.useSyncExternalStore(C.useCallback(a=>r.subscribe(it.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=C.useCallback((a,m)=>{r.mutate(a,m).catch(st)},[r]);if(n.error&&qt(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:o,mutateAsync:n.mutate}}/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=$t("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),Bt="ascendpath_saved_roadmaps";function ue(s){return s===0?"draft":s===100?"completed":"in-progress"}function ge(s){const t=new Date(s),r=Math.floor((new Date().getTime()-t.getTime())/1e3);return r<60?"just now":r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:r<604800?`${Math.floor(r/86400)}d ago`:r<2592e3?`${Math.floor(r/604800)}w ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function at(){try{const s=localStorage.getItem(Bt);return s?JSON.parse(s):[]}catch{return[]}}function Ot(s){localStorage.setItem(Bt,JSON.stringify(s))}async function ce(s){const{data:t,error:e}=await Rt.from("roadmaps").select(`
      id,
      title,
      description,
      created_at,
      updated_at,
      phases(
        id,
        milestones(id, completed)
      )
    `).eq("user_id",s).order("updated_at",{ascending:!1});if(e)throw e;return t?t.map(r=>{var v,y,c;const n=((v=r.phases)==null?void 0:v.flatMap(x=>x.milestones||[]))||[],o=n.filter(x=>x.completed).length,a=n.length,m=a>0?Math.round(o/a*100):0,f=((y=r.title)==null?void 0:y.replace(/roadmap/i,"").trim())||"Career Goal";return{id:r.id,title:r.title,description:r.description,goalRole:f,progress:m,milestoneCount:a,completedMilestones:o,phaseCount:((c=r.phases)==null?void 0:c.length)||0,status:ue(m),savedAt:r.created_at,updatedAt:r.updated_at}}):[]}function le(){const{user:s}=rt();return he({queryKey:["saved-roadmaps",s==null?void 0:s.id],queryFn:()=>s!=null&&s.id?ce(s.id):Promise.resolve(at()),enabled:!0,staleTime:2*60*1e3,retry:1})}function ve(s){const{data:t}=le();return!s||!t?!1:t.some(e=>e.id===s)}function ye(){const s=J(),{user:t}=rt();return Ct({mutationFn:async e=>{if(!(t!=null&&t.id)){const r=at(),n=new Date().toISOString(),o={...e,savedAt:n,updatedAt:n},a=r.filter(m=>m.id!==e.id);return Ot([o,...a]),o}return{...e,savedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}},onSuccess:()=>{s.invalidateQueries({queryKey:["saved-roadmaps"]}),j.success("Added to Your Saved Roadmaps",{description:"You can access it anytime from your dashboard",icon:"â­"})},onError:e=>{j.error("Failed to save roadmap",{description:e.message})}})}function be(){const s=J(),{user:t}=rt();return Ct({mutationFn:async e=>{if(!(t!=null&&t.id)){const o=at().filter(a=>a.id!==e);return Ot(o),e}const{error:r}=await Rt.from("roadmaps").delete().eq("id",e).eq("user_id",t.id);if(r)throw r;return e},onSuccess:()=>{s.invalidateQueries({queryKey:["saved-roadmaps"]}),s.invalidateQueries({queryKey:["roadmap"]}),j.success("Roadmap removed",{description:"The roadmap has been removed from your saved list"})},onError:e=>{j.error("Failed to remove roadmap",{description:e.message})}})}function Re(){const s=J(),{user:t}=rt();return Ct({mutationFn:async({roadmapId:e,newTitle:r})=>{if(!(t!=null&&t.id)){const a=at().map(m=>m.id===e?{...m,title:r,updatedAt:new Date().toISOString()}:m);return Ot(a),{roadmapId:e,newTitle:r}}const{error:n}=await Rt.from("roadmaps").update({title:r,updated_at:new Date().toISOString()}).eq("id",e).eq("user_id",t.id);if(n)throw n;return{roadmapId:e,newTitle:r}},onSuccess:()=>{s.invalidateQueries({queryKey:["saved-roadmaps"]}),s.invalidateQueries({queryKey:["roadmap"]}),j.success("Roadmap renamed")},onError:e=>{j.error("Failed to rename roadmap",{description:e.message})}})}export{me as B,ve as a,he as b,Ct as c,be as d,Re as e,le as f,ge as g,ye as u};
